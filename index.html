<!DOCTYPE html>
<html lang="en">
<head>
    <base href="/culturadigital1/">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Antonio Miguel García del Río. Cultura Digital PEC1 </title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">

    <!-- 1 -->
    <link title="timeline-styles" rel="stylesheet" href="https://cdn.knightlab.com/libs/timeline3/latest/css/timeline.css">

    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">

    <!-- 2 -->
    <script src="https://cdn.knightlab.com/libs/timeline3/latest/js/timeline.js"></script>

    <link rel="stylesheet" href="layout.css">
    <link rel="stylesheet" href="style.css">


</head>
<body>
<h1>Antonio Miguel García del Río. Cultura Digital PEC1</h1>
<div id='timeline-embed'></div>

<!-- 3 -->
<script type="text/javascript">
    (function()  {
        // creo etiqueta de video para insertar en la diapo final
        const video = document.createElement('video');
        // algunos parámetros iniciales
        const additionalOptions = {
            start_at_end: false,
            default_bg_color: {r:0, g:0, b:0},
            timenav_height: 200,
            language: "es",
            font: "pt",
            hash_bookmark: true,
            soundcite: true,
        }
        // ruta del fichero de datos
        const timeline_json = 'timeline.json';
        // creo el objeto timeline
        var timeline = new TL.Timeline('timeline-embed', timeline_json, additionalOptions);
        // cuando se ha terminado de crear todo el timeline asigno estilos a capas e inserto el contenedor del vídeo
        timeline.on('loaded', function(evt) {
            evt.events.forEach(element => {
                if(element.css) {
                    const div = document.getElementById(element.unique_id)
                    if(div) { div.dataset.css = element.css; }
                    const marker = document.getElementById(`${element.unique_id}-marker`)
                    if(marker) { marker.dataset.css = element.css; }
                }
            });
            const containers = document.querySelectorAll('.tl-slide')
            const the_end = document.getElementById('the-end')
            const tl_media = the_end.querySelector('.tl-media')
            tl_media.setAttribute('class','my-class')
            video.src = 'img/the-end.mov';
            video.controls = true;
            video.autoplay = false;
            tl_media.prepend(video)
        })
        // Cada vez que se cambia de diapositiva para controlar el estado del reproductor
        timeline.on('change', function(evt) {
            if(evt.unique_id==='the-end') {
                video.play();
            } else {
                video.pause();
                video.currentTime = 0;
            }
        });

        // Abrir los enlaces en una nueva pestaña
        document.addEventListener('click', function(event) {
            if (event.target.classList.contains('tl-makelink')) {
                event.preventDefault();
                window.open(event.target.href, '_blank');
            }
        })
    }).call(this)
</script>
</body>
</html>